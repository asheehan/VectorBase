<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>phpDocumentor Documentation</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" href="../css/template.css" type="text/css"></link><script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script><script type="text/javascript" src="../js/jquery.tools.min.js"></script><script type="text/javascript" src="../js/jquery-ui-1.8.2.custom.min.js"></script><script type="text/javascript" src="../js/template.js"></script></head><body><div id="content"><h1 class="file">include/utilities.php</h1><div id="file-nav-box"><div id="file-nav-options">
              Show:
              <img src="../images/icons/visibility_public.png" alt="Public" id="show-public"></img><img src="../images/icons/visibility_protected.png" alt="Protected" id="show-protected"></img><img src="../images/icons/visibility_private.png" alt="Private" id="show-private"></img><span class="attribute" id="show-inherited">inherited</span></div><div id="file-nav-container"><ul id="file-nav"></ul><div style="clear: left;"></div></div><div id="file-nav-tab">
              Table of Contents
          </div></div><a name="top" class="anchor"></a><div id="file-description"><div class="short-description">This file contains a set of utility functions that both serve as core functions
for certain actions related to "downloadable_files"/"Data files", as well as
auxilliary functions that makes coding easeier and cleaner for the developer.</div><div class="long-description"></div></div><dl class="file-info"><dt>Filesource</dt><dd>
         
    </dd><dt>Package</dt><dd>DataFiles
         
    </dd></dl><a name="functions" class="anchor"></a><h2>Functions</h2><div><a id="::convertNames()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">convertNames</span><span class="nb-faded-text">()</span> : void</code><div class="description"><p class="short_description">Attempted auto-convert of all files in drupal to a normalized format.</p></div><div class="code-tabs"><div class="long-description"></div><strong>Details</strong><dl class="function-info"><dt>Todo</dt><dd>This will likely be removed when the file-name conversion is figured
out and may not even be used.
         
    </dd></dl></div><div class="clear"></div></div><a id="::download_file_post_render()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">download_file_post_render</span><span class="nb-faded-text">(string $content, array $element)</span> : string</code><div class="description"><p class="short_description">Re-writes the file links to display "human readable" filesize.</p></div><div class="code-tabs"><div class="long-description"><p>Function is added into the "post_render" stack by this module's
implementation of hook_node_view_alter.</p></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$content</th><td>string</td><td><em><p>HTML content to be displayed.</p></em></td></tr><tr><th>$element</th><td>array</td><td><em><p>Container for the renderable page.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>string</td><td>Returning the given content variable.  This is probably not
necessary, but to avoid possibly breaking things, this is left in.</td></tr></table></div><div class="clear"></div></div><a id="::downloadable_file_views_query_alter()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">downloadable_file_views_query_alter</span><span class="nb-faded-text">(object $view, object $query)</span> : void</code><div class="description"><p class="short_description">Drupal 7 implementation of hook_views_query_alter.</p></div><div class="code-tabs"><div class="long-description"><p>This implementation alters filtered queries in the "Downloads/Data files"
view. It allows a user to filter by a term in the file type taxonomy
and get matches for that term AND its child terms.</p></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$view</th><td>object</td><td><em><p>Drupal view object.</p></em></td></tr><tr><th>$query</th><td>object</td><td><em><p>Drupal query object.</p></em></td></tr></table><strong>Details</strong><dl class="function-info"><dt>See</dt><dd>\global\hook_views_query_alter(&$view,
         
    </dd></dl></div><div class="clear"></div></div><a id="::errAdd()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">errAdd</span><span class="nb-faded-text">(string $element, string $msg, int[] | string[] $errArray)</span> : void</code><div class="description"><p class="short_description">Convenience method to add an error message to an error array map.</p></div><div class="code-tabs"><div class="long-description"><p>This is geared for use in the Drupal forms, where the "element" is the
name of the UI element that the error applies to. msg is the message, and
the errArray is the pass-by-reference variable to hold the message.</p></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$element</th><td>string</td><td><em><p>Key for the error.</p></em></td></tr><tr><th>$msg</th><td>string</td><td><em><p>Error message.</p></em></td></tr><tr><th>$errArray</th><td>int[] | string[]</td><td><em><p>Array that holds the errors. These are added by reference.</p></em></td></tr></table></div><div class="clear"></div></div><a id="::getFileSizeHumanReadable()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">getFileSizeHumanReadable</span><span class="nb-faded-text">(int $bytes, int $precision = 2)</span> : string</code><div class="description"><p class="short_description">Convenience method to calculate, in human-readable text, the
size of something given the bytes and precision.</p></div><div class="code-tabs"><div class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$bytes</th><td>int</td><td><em><p>Number of bytes to convert.</p></em></td></tr><tr><th>$precision</th><td>int</td><td><em><p>How many decimal places to be specific to. default is set to 2.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>string</td><td>Human readable string of the size given. Values will be
in either B, KB, MB, GB, or TB. Note, if something larger than TB is
given, returned value will not be correct, it will return that same
number as B.</td></tr></table></div><div class="clear"></div></div><a id="::getShortNames()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">getShortNames</span><span class="nb-faded-text">()</span> : void</code><div class="description"><p class="short_description">Simple getter that returns a map from common orgnism shortnames to their
full names in "genus-species" format.</p></div><div class="code-tabs"><div class="long-description"><p>This function was specifically designed
for the Download Files Name format.</p></div><strong>Details</strong><dl class="function-info"><dt>Todo</dt><dd>Might remove this b/c the names no longer follow the name format.
         
    </dd></dl></div><div class="clear"></div></div><a id="::getSortedFiles()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">getSortedFiles</span><span class="nb-faded-text">(int | string $organismId, int | string $tagId, int $limit)</span> : <a href="../files/include.heap.html#\DownloadSimpleHeap">\DownloadSimpleHeap</a></code><div class="description"><p class="short_description">Returns a max heap object of ranked files.</p></div><div class="code-tabs"><div class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$organismId</th><td>int | string</td><td><em><p>Organism taxonomy id to be ranked on.</p></em></td></tr><tr><th>$tagId</th><td>int | string</td><td><em><p>(Optional) $tagId Taxon Id of a Tag that is used by downloads to promote certain files over others.</p>
</em></td></tr><tr><th>$limit</th><td>int</td><td><em><p>(Optional) Number of files to return in the ranking.</p>
</em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td><a href="../files/include.heap.html#\DownloadSimpleHeap">\DownloadSimpleHeap</a></td><td>A max heap object of ranked files (drupal nodes).</td></tr></table></div><div class="clear"></div></div><a id="::getUniqueListOrgTidsFromDownloads()" class="anchor"></a><div class="function "><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/function.png" alt="function" title="function"></img><span class="highlight">getUniqueListOrgTidsFromDownloads</span><span class="nb-faded-text">()</span> : string[] | int[]</code><div class="description"><p class="short_description">Returns unique list of organisms referenced in exisiting data files (downloads).</p></div><div class="code-tabs"><div class="long-description"><p>Utility method designed to scan all nodes classified as "downloadable_file"s,
and return a unique list of organism taxon ids from the organism taxonomy.
Each taxon id returned has at least one "downloadable_file" node that exsits
in drupal. This method is used to display a shortened, relevant list of
organisms available to filter on in the "Data files" (downlaods) view.</p></div><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>string[] | int[]</td><td>List of organism taxon ids.</td></tr></table></div><div class="clear"></div></div></div></div><small class="footer">
            Documentation was generated by
            <a href="http://phpdoc.org">phpDocumentor
                2.0.0a10</a>.
        </small></body></html>
